# Практическое задание для отбора на кафедру КИС

Код задачи: 211

ФИО: Елисеев Артем Вячеславович

## Условие

Необходимо реализовать эффективный алгоритм поиска по строке в очень большом текстовом файле.
Вывести необходимо первое вхождение строки в тексте. Файл загружается один раз, потом происходит большое количество запросов на поиск.

## Решение

Построим **суффиксный автомат** на тексте во **внешеней памяти** (в файле) с использованием **Allocator**'а на **mmap**.
В процессе построения для каждой вершины будем также предподсчитывать динамику позиции в тексте конца первого вхождения
строки, при считывании которой мы поподаем в вершину.

Для ответа на запрос нужно прочитать паттерн суффиксным автоматом и вывести значение динамики.

Реализация позволяет построить суффиксный автомат и в оперативной памяти, но если файл очень большой, то (хотя и автомат занимает O(n) памяти) ОЗУ может не хватить. Поэтому я реализовал свой Allocator, который аллоцирует память в файле с помощью mmap.

## Асимптотика

Пусть n - длина текста, m - длина паттерна.

Тогда алгоритм требует **O(n)** времени и памяти на построение, **O(m)** времени на запрос.

## Сборка и запуск

На Linux

```
mkdir build
cd build
cmake ..
make -j5
```

Далее нужно увеличить лимит на максимальное количество выделенной виртуальной памяти (могут понадобится права
администратора)

```ulimit -v 4194304``` (4GB)

Теперь можно запустить бинарник.

## Тесты

В репозитории присутствую базовые тесты в цели `tests`. В качестве тестового файла была взята книга "Война и мир" на
английском. Также решение тестировалось на геноме человека (можно скачать
по [ссылке](https://download.rgd.mcw.edu/data_release/HUMAN/GRCh38-derived_transcript_sequences.fa.gz)).

## В планах реализовать

- Алгоритм FM-index с wavelet tree, который должен занимать гораздо меньше памяти и быстрее работать 